---
title: Command Flags
sidebar_position: 3
---

import Tabs from '@theme/Tabs'
import TabItem from '@theme/TabItem'

Flagged options are passed to the command closure as
a plain object.

```javascript title="~/my-project/index.js"
// highlight-next-line
const greetCommand = function greet(flags) {
  return function parse([greet, name]) {

    // highlight-next-line
    console.log(flags)
    return `${greet}, ${name}!`
  }
}

...
```

Options may be passed using camelCase or hyphenated names.
Nested options are supported using dot notation.

<Tabs
  groupId="pkg-manager"
  defaultValue="pnpm"
  values={[
    {label: 'npm', value: 'npm'},
    {label: 'pnpm', value: 'pnpm'},
    {label: 'yarn', value: 'yarn'},
  ]}>
  <TabItem value="npm">

```bash title="~/my-project"
$ npm run cmv -- greet hello world --option-one first \
--optionTwo second --nested.option third
# outputs
{
  'option-one': 'first',
  optionOne: 'first',
  optionTwo: NaN,
  'option-two': NaN,
  nested: { option: 'third' },
}
...
```

  </TabItem>
  <TabItem value="pnpm">

```bash title="~/my-project"
$ pnpm cmv greet hello world --option-one first \
--optionTwo second --nested.option third
# outputs
{
  'option-one': 'first',
  optionOne: 'first',
  optionTwo: NaN,
  'option-two': NaN,
  nested: { option: 'third' },
}
...
```

  </TabItem>
  <TabItem value="yarn">

```bash title="~/my-project"
$ yarn cmv greet hello world --option-one first \
--optionTwo second --nested.option third
# outputs
{
  'option-one': 'first',
  optionOne: 'first',
  optionTwo: NaN,
  'option-two': NaN,
  nested: { option: 'third' },
}
...
```

  </TabItem>
</Tabs>

Notice that flags can be set using camelCase or hyphenated names
but are actually available off the flags object using either notation.

There is one problem with the current CLI program.
Commandville knows nothing about the available options.
Running `$ cmv greet --help` produces a message of little help.

<Tabs
  groupId="pkg-manager"
  defaultValue="pnpm"
  values={[
    {label: 'npm', value: 'npm'},
    {label: 'pnpm', value: 'pnpm'},
    {label: 'yarn', value: 'yarn'},
  ]}>
  <TabItem value="npm">

```bash title="~/my-project"
$ npm run cmv -- greet --help
# outputs
cmv greeting

Options:
  --help     Show help                                                 [boolean]
  --version  Show version number                                       [boolean]
```

  </TabItem>
  <TabItem value="pnpm">

```bash title="~/my-project"
$ pnpm cmv greet --help
# outputs
cmv greeting

Options:
  --help     Show help                                                 [boolean]
  --version  Show version number                                       [boolean]
```

  </TabItem>
  <TabItem value="yarn">

```bash title="~/my-project"
$ yarn cmv greet --help
# outputs
cmv greeting

Options:
  --help     Show help                                                 [boolean]
  --version  Show version number                                       [boolean]
```

  </TabItem>
</Tabs>

Let's fix that by adding an `.options` property to the command closure
to define the available/expected CLI options.

```javascript title="~/my-project/index.js"
const greetCommand = function greet(flags) {
  return function parse([greet, name]) {
    console.log(flags)
    return `${greet}, ${name}!`
  }
}

greetCommand.command = 'greet'

// highlight-start
greetCommand.options = {
  optionOne: {
    description: 'Option One',
    type: 'string',
  },
  'option-two': {
    description: 'more options',
    type: 'number',
  },
  'nested.option': {
    description: 'nested option',
    type: 'string',
  },
}
// highlight-end

module.exports = greetCommand
```

Now running `$ cmv greet --help` produces a more insightful message.

<Tabs
  groupId="pkg-manager"
  defaultValue="pnpm"
  values={[
    {label: 'npm', value: 'npm'},
    {label: 'pnpm', value: 'pnpm'},
    {label: 'yarn', value: 'yarn'},
  ]}>
  <TabItem value="npm">

```bash title="~/my-project"
$ npm run cmv -- greet --help
# outputs
cmv greeting

Options:
  --help           Show help                                           [boolean]
  --version        Show version number                                 [boolean]
  --optionOne      Option One                                           [string]
  --option-two     more options                                         [number]
  --nested.option  nested option                                        [string]
```

  </TabItem>
  <TabItem value="pnpm">

```bash title="~/my-project"
$ pnpm cmv greet --help
# outputs
cmv greeting

Options:
  --help           Show help                                           [boolean]
  --version        Show version number                                 [boolean]
  --optionOne      Option One                                           [string]
  --option-two     more options                                         [number]
  --nested.option  nested option                                        [string]
```

  </TabItem>
  <TabItem value="yarn">

```bash title="~/my-project"
$ yarn cmv greet --help
# outputs
cmv greeting

Options:
  --help           Show help                                           [boolean]
  --version        Show version number                                 [boolean]
  --optionOne      Option One                                           [string]
  --option-two     more options                                         [number]
  --nested.option  nested option                                        [string]
```

  </TabItem>
</Tabs>

The `--help` menu preserves the
formatting of how the flag is defined
but again, either camelCase or hyphenated flags may be used
when calling the CLI command.

:::caution

`type` and `description` are required properties when defining options.

:::

## Option Types

```typescript
type: 'string' | 'number' | 'boolean' | 'count'
```

`count` specifies a `boolean` flag that keeps track, or counts, the number
of times the flag is used.

## Default Flags

```javascript title="~/my-project"
...

cmd.options = {
  optionOne: {
    description: 'Option One',
    type: 'string',
    // highlight-next-line
    default: 'Yes'
  },
  ...
}
```

## Array Flags

```javascript title="~/my-project"
...

cmd.options = {
  optionOne: {
    description: 'Option One',
    type: 'string',
    // highlight-next-line
    array: true
  },
  ...
}
```

### Default Array Flags

```javascript title="~/my-project"
...

cmd.options = {
  optionOne: {
    description: 'Option One',
    type: 'string',
    array: true,
    // highlight-next-line
    default: ['one', 'two']
  },
  ...
}
```

## Required Flags

```javascript title="~/my-project"
...

cmd.options = {
  optionOne: {
    description: 'Option One',
    type: 'string',
    // highlight-next-line
    required: true,
  },
  ...
}
```

## Require Arguments

Running `$ cmv greet --option-one` satisfies the `required`
constraint but perhaps the option requires arguments. That is
what `reuiresArgs` speficies.

```javascript title="~/my-project"
...

cmd.options = {
  optionOne: {
    description: 'Option One',
    type: 'string',
    required: true,
    // highlight-next-line
    requireArgs: true
  },
  ...
}
```

Now the required constraint is only satisfied when arguments are
provided for the `--option-one` flag. Note that you may use
`requiresArgs` without the `required` constraint, making arguments
necessary when using the option but the option itself is optional.

### Specify Number of Expected Arguments

When using `requiresArgs` it is also possible to specify
the number of expected args.

```javascript title="~/my-project"
...

cmd.options = {
  optionOne: {
    description: 'Option One',
    type: 'string',
    required: true,
    requireArgs: true,
    // highlight-next-line
    nargs: 2
  },
  ...
}
```

## Flag Aliases

```javascript title="~/my-project"
...

cmd.options = {
  optionOne: {
    description: 'Option One',
    type: 'string',
    required: true,
    // highlight-next-line
    aliases: ['o', 'p']
  },
  ...
}
```

Either `-o` or `-p` can be used in place of `--option-one`.

## Choice Flags

```javascript title="~/my-project"
...

cmd.options = {
  optionOne: {
    description: 'Option One',
    type: 'string',
    required: true,
    alias: ['o', 'p'],
    choices: ['Yes', 'No']
  },
  ...
}
```

## Coerce Flags

A synchronous function for coercing input arguments.
Here is an example of parsing an argument as a JSON file.

```javascript title="~/my-project"
...

cmd.options = {
  optionOne: {
    description: 'Option One',
    type: 'string',
    requiresArgs: true,
    nargs: 1,
    // highlight-start
    coerce: (filePath) => {
      return JSON.parse(fs.readFileSync(filePath, 'utf-8'))
    }
    // highlight-end
  },
  ...
}
```

## Flag Validation

By throwing an error, `coerce` may also be used to validate flags.

```javascript title="~/my-project"
...

cmd.options = {
  optionOne: {
    ...
    // highlight-start
    coerce: (filePath) => {
      if (!fs.existsSync(filePath)) {
        throw new Error(`${filePath} does not exist.`)
      }
      return JSON.parse(fs.readFileSync(filePath, 'utf-8'))
    }
    // highlight-end
  },
  ...
}
```
