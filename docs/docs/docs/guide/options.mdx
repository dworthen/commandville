---
title: Command Flags
sidebar_position: 3
---

import Tabs from '@theme/Tabs'
import TabItem from '@theme/TabItem'

# Command Flags

## Boolean flag

Let's add a flag to indicate that this is an excited greeting.

```javascript title="~/my-project/index.js"
// highlight-next-line
const greetCommand = function greet({ excited }) {
  return function parse([greeting, name]) {
    // highlight-next-line
    return `${greeting}, ${name}${excited ? '!' : '.'}`
  }
}

greetCommand.command = 'greeting'
// highlight-start
greetCommand.options = {
  excited: {
    type: 'boolean',
    description: 'Is the message exciting?',
  },
}
// highlight-end

module.exports = greetCommand
```

Now we can greet someone with some enthusiasm.

<Tabs
  groupId="pkg-manager"
  defaultValue="pnpm"
  values={[
    {label: 'npm', value: 'npm'},
    {label: 'pnpm', value: 'pnpm'},
    {label: 'yarn', value: 'yarn'},
  ]}>
  <TabItem value="npm">

```bash title="~/my-project"
$ npm run cmv -- greet hello world --excited
hello, world!
```

  </TabItem>
  <TabItem value="pnpm">

```bash title="~/my-project"
$ pnpm cmv greet hello world --excited
hello, world!
```

  </TabItem>
  <TabItem value="yarn">

```bash title="~/my-project"
$ yarn cmv greet hello world --excited
hello, world!
```

  </TabItem>
</Tabs>

:::info

boolean flags can be negated using `--no-` . In this case, `--no-excited`.

:::

:::caution

`type` and `description` are required properties when defining options.

:::

## Default flags

Flags also support default values.
Let's support using a custom punctuation mark for exciting messages
and default to using '!'.

```javascript title="~/my-project/index.js"
// highlight-next-line
const greetCommand = function greet({ excited, mark = '!' }) {
  return function parse([greeting, name]) {
    // highlight-next-line
    return `${greeting}, ${name}${excited ? mark : '.'}`
  }
}

greetCommand.command = 'greeting'
greetCommand.options = {
  excited: {
    type: 'boolean',
    description: 'Is the message exciting?',
  },
  // highlight-start
  mark: {
    type: 'string',
    description: 'Punctuation mark to use for exciting messages.',
    default: '!',
  },
  // highlight-end
}

module.exports = greetCommand
```

:::info

It may seem redundant to specify a default value in the command options object
and to use es6 default notation but they solve different problems.
Es6 default notation allows us to use the the function programmatically,
to compose larger CLIs from smaller ones.
The default value specified in the command options object helps
`cmv` generate a help message and to lift the function as a CLI.
Composing CLIs out of smaller, reusable functions will be visited in
another article.

:::

## Counting Flags

Istead of specifying `excited` as a boolean, let's update the flag
to allow to be specified multiple times. That way we can count how many
times the flag was used and make the message

```javascript title="~/my-project/index.js"
const greetCommand = function greet({ excited, mark = '!' }) {
  return function parse([greeting, name]) {
    // highlight-next-line
    return `${greeting}, ${name}${excited ? ''.padEnd(excited, mark) : '.'}`
  }
}

greetCommand.command = 'greeting'
greetCommand.options = {
  excited: {
    // highlight-next-line
    type: 'count',
    description: 'Is the message exciting?',
  },
  mark: {
    type: 'string',
    description: 'Punctuation mark to use for exciting messages.',
    default: '!',
  },
}

module.exports = greetCommand
```

<Tabs
  groupId="pkg-manager"
  defaultValue="pnpm"
  values={[
    {label: 'npm', value: 'npm'},
    {label: 'pnpm', value: 'pnpm'},
    {label: 'yarn', value: 'yarn'},
  ]}>
  <TabItem value="npm">

```bash title="~/my-project"
$ npm run cmv -- greet hello world \
--excited --excited --excited
hello, world!!!
```

  </TabItem>
  <TabItem value="pnpm">

```bash title="~/my-project"
$ pnpm cmv greet hello world \
--excited --excited --excited
hello, world!!!
```

  </TabItem>
  <TabItem value="yarn">

```bash title="~/my-project"
$ yarn cmv greet hello world \
--excited --excited --excited
hello, world!!!
```

  </TabItem>
</Tabs>

## Flag Aliases

Needing to repeatedly pass a full flag is tedious.
Let's assign a flag alias to make things easier.

```javascript title="~/my-project/index.js"
const greetCommand = function greet({ excited, mark = '!' }) {
  return function parse([greeting, name]) {
    return `${greeting}, ${name}${excited ? ''.padEnd(excited, mark) : '.'}`
  }
}

greetCommand.command = 'greeting'
greetCommand.options = {
  excited: {
    type: 'count',
    description: 'Is the message exciting?',
    // highlight-next-line
    aliases: ['e'],
  },
  mark: {
    type: 'string',
    description: 'Punctuation mark to use for exciting messages.',
    default: '!',
  },
}

module.exports = greetCommand
```

<Tabs
  groupId="pkg-manager"
  defaultValue="pnpm"
  values={[
    {label: 'npm', value: 'npm'},
    {label: 'pnpm', value: 'pnpm'},
    {label: 'yarn', value: 'yarn'},
  ]}>
  <TabItem value="npm">

```bash title="~/my-project"
$ npm run cmv -- greet hello world -eee
hello, world!!!
```

  </TabItem>
  <TabItem value="pnpm">

```bash title="~/my-project"
$ pnpm cmv greet hello world -eee
hello, world!!!
```

  </TabItem>
  <TabItem value="yarn">

```bash title="~/my-project"
$ yarn cmv greet hello world -eee
hello, world!!!
```

  </TabItem>
</Tabs>

## Coercing Flags

Let's support repeating the output message by adding a `repeat` flag.
This flag should be a whole number as we don't want to repeat
the message a fractional number of times.

```javascript title="~/my-project/index.js"
// highlight-next-line
const greetCommand = function greet({ excited, mark = '!', repeat = 1 }) {
  return function parse([greeting, name]) {
    // highlight-start
    const message = `${greeting}, ${name}${
      excited ? ''.padEnd(excited, mark) : '.'
    }`
    return ''.padEnd(message.length * repeat, message)
    // highlight-end
  }
}

greetCommand.command = 'greeting'
greetCommand.options = {
  excited: {
    type: 'count',
    description: 'Is the message exciting?',
    aliases: ['e'],
  },
  mark: {
    type: 'string',
    description: 'Punctuation mark to use for exciting messages.',
    default: '!',
  },
  // highlight-start
  repeat: {
    type: 'number',
    description: 'Repeat the message x number of times.',
    default: 1,
    // coerce number to be an integer
    coerce: (val) => val | 0,
  },
  // highlight-end
}

module.exports = greetCommand
```

## Validation

By throwing an error, `coerce` may also be used to validate flags.
The above example coerces a fractional number to an integer but
what if the user inputs text instead of a number or a negative number.
Let's check that the value can be coerced to an integer and is positive.

```javascript title="~/my-project/index.js"
const greetCommand = function greet({ excited, mark = '!', repeat = 1 }) {
  return function parse([greeting, name]) {
    const message = `${greeting}, ${name}${
      excited ? ''.padEnd(excited, mark) : '.'
    }`
    return ''.padEnd(message.length * repeat, message)
  }
}

greetCommand.command = 'greeting'
greetCommand.options = {
  excited: {
    type: 'count',
    description: 'Is the message exciting?',
    aliases: ['e'],
  },
  mark: {
    type: 'string',
    description: 'Punctuation mark to use for exciting messages.',
    default: '!',
  },
  repeat: {
    type: 'number',
    description: 'Repeat the message x number of times.',
    default: 1,
    // highlight-start
    coerce: (val) => {
      const parsed = parseInt(val)
      if (isNaN(parsed) || parsed < 0) {
        throw new Error(`--repeat must be a positive integer.`)
      }
      return parsed
    },
    // highlight-end
  },
}

module.exports = greetCommand
```

View [command flags](../references/flags) for a full list of flag types.
